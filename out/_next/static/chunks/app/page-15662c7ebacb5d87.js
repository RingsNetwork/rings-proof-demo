(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6328:function(e,o,t){Promise.resolve().then(t.bind(t,8836))},8836:function(e,o,t){"use strict";t.r(o),t.d(o,{default:function(){return w}});var r=t(3827),s=t(4090),n=t(703),l=t(6480),a=t.n(l),i=t(510),c=t(6222),g=t(5690),d=t.n(g),u=t(5908),f=t(5285);let m=async(e,o,t,r)=>{console.log("service_message_handler"),console.log(r)},h=async(e,o,t,r)=>{console.log("plain_text_message_handler"),console.log(r)},p=async(e,o,t,r)=>{console.log("extension_message_handler"),console.log(r)};function w(){let[e,o]=(0,s.useState)(null),[l,w]=(0,s.useState)(null),[x,k]=(0,s.useState)(null);(0,s.useEffect)(()=>{e||(async()=>{o(await d()())})()},[e]),(0,s.useEffect)(()=>{e&&(console.log("wasm found"),async function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:250,n=[],l=[];for(let o=0;o<e;o++){let e=(0,u.w)();l.push(e)}l.sort((e,o)=>{let t=(0,f.L)(e).address.toLowerCase(),r=(0,f.L)(o).address.toLowerCase();return t>r?-1:t<r?1:0});for(let a=0;a<e;a++){let i=2*Math.PI*a/e,c=r+o*Math.cos(i),d=s+o*Math.sin(i),u=l[a],w=(0,f.L)(u),x=async e=>{let o=await w.signMessage({message:e});return new Uint8Array(function(e){e=(e=e.toString(16)).replace(/^0x/i,"");for(var o=[],t=0;t<e.length;t+=2)o.push(parseInt(e.slice(t,t+2),16));return o}(o))},k=async()=>{let e=new g.SNARKBehaviour,o=new g.BackendBehaviour(m,h,p,e.clone()),r=await new g.Provider("stun://stun.qq.com:3478",BigInt(1),w.address,"eip191",x,o);if(await r.listen(),a>0){console.log("w1");let e=n[a-1],o=new g.rings_node.CreateOfferRequest({did:w.address}),t=await e.provider.request("createOffer",o);console.log("w2");let s=new g.rings_node.AnswerOfferRequest({offer:t.offer}),l=await r.request("answerOffer",s);console.log("w3");let i=new g.rings_node.AcceptAnswerRequest({answer:l.answer});await e.provider.request("acceptAnswer",i),console.log("w4")}let s=new Worker(t.tu(new URL(t.p+t.u(554),t.b)));s.onmessage=function(e){console.log(e.data)};var l={type:"init"};s.postMessage(l);var i={type:"config",pk:u};s.postMessage(i),console.log(a),n.push({x:c,y:d,pk:u,account:w,provider:r,snark:e,worker:s,isCommiter:!1,isWorker:!1})};await k()}w(n)}(16))},[e]);let b=async()=>{console.log(l[0]);let e=g.SupportedPrimeField.Vesta;console.log("loading r1cs and wasm START");let o=await new g.SNARKTaskBuilder("http://localhost:3000/test_sha256.r1cs","http://localhost:3000/test_sha256.wasm",e);console.log("loading r1cs and wasm DONE"),console.log("init input START");let t=[["in",Array(256).fill(BigInt(0))]],r=g.Input.from_array(t,e),s=[].map(o=>g.Input.from_array(o,e));console.log("init input DONE"),console.log(r),console.log("gen circuit START"),console.log(s);let n=o.gen_circuits(r,s,36);console.log(n);var a=[];for(let e=0;e<n.length;e++){let o=n[e].to_json();a.push(o)}l[0].worker.postMessage({type:"genProofRequest",genProofCircuits:a}),console.log("gen circuit DONE"),console.log("gen task");let i=g.SNARKBehaviour.gen_proof_task_ref(n);console.log("gen task DONE"),console.log("gen proof"),console.log(i);let c=g.SNARKBehaviour.handle_snark_proof_task_ref(i.clone());console.log("gen proof DONE"),console.log("verify"),console.log("verify DONE",g.SNARKBehaviour.handle_snark_verify_task_ref(c.clone(),i.clone()))},v=async()=>{let e=g.SupportedPrimeField.Vesta;console.log("loading r1cs and wasm START");let o=await new g.SNARKTaskBuilder("http://localhost:3000/test_sha256.r1cs","http://localhost:3000/test_sha256.wasm",e);console.log("loading r1cs and wasm DONE"),console.log("init input START");let t=[["in",Array(256).fill(BigInt(0))]],r=g.Input.from_array(t,e),s=[].map(o=>g.Input.from_array(o,e));console.log("init input DONE"),console.log("gen circuit START"),console.log(s);let n=o.gen_circuits(r,s,36);console.log("gen circuit DONE"),console.log("gen task");for(let e=0;e<6;e++){console.log("to json START");var a=[];for(let o=0;o<6;o++){let t=n[e+o].to_json();a.push(t)}console.log("to json END");let o=e%l.length;var i={type:"genProofRequest",genProofCircuits:a};console.log("send task"),l[o].worker.postMessage(i)}l[0].isCommiter=!0;let c=await l[0].provider.request("nodeInfo",[]);var d=0;c.swarm.peers.map(e=>{if("Connected"==e.state)for(let o=0;o<l.length;o++){let t=l[o];if(t.account.address.toLowerCase()==e.did.toLowerCase()){d<6&&(t.isWorker=!0),d+=1;break}}}),w(l)};(0,s.useEffect)(()=>{let e=setInterval(async()=>{if(null!=l){var e=[];for(let o=0;o<l.length;o++){let t=l[o];(await t.provider.request("nodeInfo",[])).swarm.peers.map(o=>{if("Connected"==o.state){var r;for(let e=0;e<l.length;e++){let t=l[e];if(t.account.address.toLowerCase()==o.did.toLowerCase()){r=t;break}}null!=r&&t!=r&&e.push({source:t,target:r,messaging:t.isCommiter&&r.isWorker||t.isWorker&&r.isCommiter})}})}k({nodes:l,links:e})}},1e3);return()=>clearInterval(e)},[l]);let y=a()("fixed","left-0","top-0","flex","w-full","justify-center","border-b","border-gray-300","bg-gradient-to-b from-zinc-200 dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto lg:rounded-xl lg:border lg:bg-gray-200 lg:p-2 lg:dark:bg-zinc-800/30"),_=a()("group rounded-lg border border-transparent px-5 py-4 transition-colors hover:border-gray-300 hover:bg-gray-100 hover:dark:border-neutral-700 hover:dark:bg-neutral-800/30");return(0,r.jsxs)("main",{className:"flex min-h-screen flex-col items-center p-24",children:[(0,r.jsxs)("div",{className:"z-10 max-w-5xl w-full items-center justify-between font-mono text-sm lg:flex",children:[(0,r.jsxs)("p",{className:"fixed left-0 top-0 flex w-full justify-center border-b border-gray-300 bg-gradient-to-b from-zinc-200 pb-6 pt-8 backdrop-blur-2xl dark:border-neutral-800 dark:bg-zinc-800/30 dark:from-inherit lg:static lg:w-auto  lg:rounded-xl lg:border lg:bg-gray-200 lg:p-4 lg:dark:bg-zinc-800/30",children:["Decentralized Proof Demo\xa0",(0,r.jsx)("a",{href:"https://github.com/RingsNetwork/rings-proof-demo",target:"_blank",children:(0,r.jsx)("code",{className:"font-mono font-bold",children:"[Source Code]"})})]}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 flex h-48 w-full items-end justify-center bg-gradient-to-t from-white via-white dark:from-black dark:via-black lg:static lg:h-auto lg:w-auto lg:bg-none",children:(0,r.jsxs)("a",{className:"pointer-events-none flex place-items-center gap-2 p-8 lg:pointer-events-auto lg:p-0",href:"https://ringsnetwork.io",target:"_blank",rel:"noopener noreferrer",children:["By"," ",(0,r.jsx)(n.default,{src:"/ringslogo.svg",alt:"Rings Network Logo",className:"dark:invert",width:240,height:24,priority:!0})]})})]}),(0,r.jsxs)("div",{className:"z-10 max-w-5xl w-full items-center justify-between font-mono text-sm lg:flex",children:[(0,r.jsx)("p",{className:y,onClick:()=>{},children:"1. Start 16 rings node"}),(0,r.jsx)("p",{className:y,children:"2. Connect them to a local network"}),(0,r.jsx)("p",{className:y,onClick:b,children:" 3. Run a proof job on 1 node"}),(0,r.jsx)("p",{className:y,onClick:v,children:" 4. Run Rings Proof"})]}),(0,r.jsx)(()=>{var e=[];if(l)for(let o=0;o<l.length;o++){let t=l[o];e.push((0,r.jsxs)("a",{className:_,target:"_blank",children:[(0,r.jsxs)("h2",{className:"mb-3 text-base font-semibold",children:["Node"," "+o,(0,r.jsx)("span",{className:"inline-block transition-transform group-hover:translate-x-1 motion-reduce:transform-none",children:"->"})]}),(0,r.jsx)("p",{className:"m-0 max-w-[30ch] text-sm opacity-50",children:t.account.address.substring(0,6)})]},t.account.address))}return(0,r.jsx)("div",{className:"mb-32 grid text-center lg:max-w-5xl lg:w-full md:w-full sm:w-full lg:mb-0 lg:grid-cols-8 md:grid-cols-8 sm:grid-cols-8 lg:text-left",children:e})},{}),(0,r.jsx)("div",{className:"mb-32 grid text-center lg:max-w-5xl lg:w-full lg:mb-0 lg:grid-cols-2 lg:text-left",children:(0,r.jsx)(()=>null!=l?(0,r.jsx)("svg",{width:"500",height:"500",children:(0,r.jsx)(i.Z,{graph:x,nodeComponent:e=>{let{node:o}=e;return(0,r.jsx)(c.Z,{onClick:()=>console.log(o),fill:o.isCommiter?"red":o.isWorker?"green":"cyan"})},linkComponent:e=>{let{link:o}=e;return(0,r.jsx)("line",{x1:o.source.x,y1:o.source.y,x2:o.target.x,y2:o.target.y,strokeWidth:2,stroke:o.messaging?"green":"#999",strokeOpacity:o.messaging?.8:.2})}})}):(0,r.jsx)("svg",{width:"500",height:"500"}),{})})]})}}},function(e){e.O(0,[210,246,627,971,69,744],function(){return e(e.s=6328)}),_N_E=e.O()}]);